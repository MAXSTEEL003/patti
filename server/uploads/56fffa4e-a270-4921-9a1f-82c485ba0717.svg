<?xml version="1.0" encoding="utf-8"?>
  <svg xmlns='http://www.w3.org/2000/svg' width='720' height='426' viewBox='0 0 720 426' preserveAspectRatio='xMinYMin meet'>
    <style>
      svg{shape-rendering:crispEdges;stroke-linecap:square;-webkit-font-smoothing:antialiased;}
      * { box-sizing: border-box; margin: 0px; padding: 0px; font-family: system-ui, -apple-system, "Segoe UI", Roboto, sans-serif; }
:root { --primary: #1e40af; --primary-light: #3b82f6; --primary-dark: #1e3a8a; --secondary: #0ea5e9; --secondary-light: #38bdf8; --secondary-dark: #0284c7; --accent: #06b6d4; --accent-light: #22d3ee; --success: #059669; --success-light: #10b981; --warning: #d97706; --danger: #dc2626; --gray-50: #f8fafc; --gray-100: #f1f5f9; --gray-200: #e2e8f0; --gray-300: #cbd5e1; --gray-400: #94a3b8; --gray-500: #64748b; --gray-600: #475569; --gray-700: #334155; --gray-800: #1e293b; --gray-900: #0f172a; --bg-primary: #eff6ff; --bg-secondary: #dbeafe; --bg-card: #ffffff; --bg-accent: linear-gradient(135deg, #1e40af 0%, #0ea5e9 100%); --radius-sm: 6px; --radius-md: 8px; --radius-lg: 12px; --radius-xl: 16px; --shadow-sm: 0 1px 2px rgba(30, 64, 175, 0.05); --shadow-md: 0 4px 6px rgba(30, 64, 175, 0.07), 0 2px 4px rgba(30, 64, 175, 0.03); --shadow-lg: 0 10px 15px rgba(30, 64, 175, 0.1), 0 4px 6px rgba(30, 64, 175, 0.05); --shadow-xl: 0 20px 25px rgba(30, 64, 175, 0.1), 0 10px 10px rgba(30, 64, 175, 0.04); --transition: 200ms cubic-bezier(0.4, 0, 0.2, 1); --transition-slow: 300ms cubic-bezier(0.4, 0, 0.2, 1); }
html { font-size: 16px; text-size-adjust: 100%; -webkit-font-smoothing: antialiased; }
body { background: var(--bg-primary); padding: clamp(12px, 3vw, 32px); color: var(--gray-900); line-height: 1.6; min-height: 100vh; }
.app { max-width: min(95vw, 1300px); margin: 0px auto; padding: clamp(20px, 4vw, 40px); background: var(--bg-card); border-radius: var(--radius-xl); box-shadow: var(--shadow-xl); backdrop-filter: blur(8px); border: 1px solid var(--gray-200); }
h1 { font-size: clamp(1.75rem, 4vw, 2.5rem); font-weight: 700; color: var(--primary); text-align: center; margin-bottom: 2rem; background-image: ; background-position-x: ; background-position-y: ; background-size: ; background-repeat: ; background-attachment: ; background-origin: ; background-color: ; -webkit-text-fill-color: transparent; background-clip: text; }
.header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem; padding-bottom: 1rem; border-bottom: 2px solid var(--gray-200); }
.header-actions { display: flex; gap: 1rem; }
.main-content { display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; margin-bottom: 2rem; }
.left-panel { display: flex; flex-direction: column; gap: 1.5rem; }
.right-panel { display: flex; flex-direction: column; gap: 1.5rem; }
.controls label { display: block; margin: 8px 0px; font-weight: 500; color: rgb(52, 73, 94); }
.form-section { background: var(--bg-card); border: 1px solid var(--gray-200); border-radius: var(--radius-lg); padding: 1.5rem; box-shadow: var(--shadow-sm); }
.form-section h2 { font-size: 1.125rem; font-weight: 600; color: var(--primary); margin-bottom: 1rem; padding-bottom: 0.5rem; border-bottom: 2px solid var(--gray-200); }
.inputs-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 1rem; width: 100%; }
.field-group { display: flex; flex-direction: column; gap: 0.5rem; }
.field-group label { font-size: 0.875rem; font-weight: 600; color: var(--gray-700); margin: 0px; }
.field-group input, .field-group select { padding: 0.75rem 1rem; border: 1px solid var(--gray-300); border-radius: var(--radius-md); background: var(--gray-50); font-size: 0.875rem; transition: var(--transition); }
.field-group input:focus, .field-group select:focus { outline: none; border-color: var(--primary); box-shadow: rgba(30, 64, 175, 0.1) 0px 0px 0px 3px; background: white; }
.inputs-grid label { display: flex; flex-direction: column; font-size: 14px; font-weight: 500; color: rgb(45, 55, 72); gap: 6px; position: relative; }
.inputs-grid input { padding: 12px 16px; border: 1px solid rgb(226, 232, 240); border-radius: 8px; font-size: 15px; line-height: 1.4; transition: 0.2s cubic-bezier(0.4, 0, 0.2, 1); background: rgb(248, 250, 252); color: rgb(26, 32, 44); box-shadow: rgba(0, 0, 0, 0.02) 0px 1px 2px inset; }
.inputs-grid input:hover { border-color: rgb(203, 213, 224); background: rgb(255, 255, 255); }
.inputs-grid input:focus { outline: none; border-color: var(--primary); box-shadow: rgba(30, 64, 175, 0.15) 0px 0px 0px 3px, rgba(0, 0, 0, 0.01) 0px 1px 2px inset; background: rgb(255, 255, 255); }
.inputs-grid input::placeholder { color: rgb(160, 174, 192); opacity: 0.8; }
.name-input { display: flex; align-items: center; gap: 0.5rem; position: relative; }
.name-select { flex: 1 1 0%; padding: 0.75rem 1rem; border-radius: var(--radius-md); border: 1px solid var(--gray-300); background-attachment: ; background-origin: ; background-clip: ; background-color: ; transition: var(--transition); font-size: 0.875rem; cursor: pointer; appearance: none; background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e"); background-repeat: no-repeat; background-position: right 0.75rem center; background-size: 1rem; }
.name-select:hover { border-color: var(--primary); background: white; }
.name-select:focus { outline: none; border-color: var(--primary); box-shadow: rgba(30, 64, 175, 0.1) 0px 0px 0px 3px; background: white; }
.name-select option { padding: 0.5rem; background: white; color: var(--gray-900); }
.name-select option:hover { background: var(--primary-light); color: white; }
.name-input input:not(.name-select) { flex: 1 1 0%; padding: 0.75rem 1rem; border-radius: var(--radius-md); border: 1px solid var(--gray-300); background: var(--gray-50); transition: var(--transition); font-size: 0.875rem; }
.name-input input:not(.name-select):hover { border-color: var(--primary); background: white; }
.name-input input:not(.name-select):focus { outline: none; border-color: var(--primary); box-shadow: rgba(30, 64, 175, 0.1) 0px 0px 0px 3px; background: white; }
.name-input button { padding: 0.75rem 1rem; border-radius: var(--radius-md); border: none; background: var(--success); color: white; font-weight: 600; font-size: 0.875rem; cursor: pointer; transition: var(--transition); box-shadow: var(--shadow-sm); white-space: nowrap; height: 100%; }
.name-input button:hover { background: var(--success-light); transform: translateY(-1px); box-shadow: var(--shadow-md); }
.name-input button:active { transform: translateY(0px); }
.name-input { display: flex; align-items: stretch; gap: 0.5rem; position: relative; }
@media (max-width: 560px) {
  .name-input { flex-direction: row; }
  .name-input button { padding: 8px; }
}
.preview-section, .controls-section { background: var(--bg-card); border: 1px solid var(--gray-200); border-radius: var(--radius-lg); padding: 1.5rem; box-shadow: var(--shadow-sm); }
.preview-section h2, .controls-section h2 { font-size: 1.125rem; font-weight: 600; color: var(--primary); margin-bottom: 1rem; padding-bottom: 0.5rem; border-bottom: 2px solid var(--gray-200); }
.clipboard-status { display: flex; align-items: center; gap: 10px; padding: 12px 16px; border-radius: 8px; background: rgb(255, 248, 225); color: rgb(26, 35, 126); font-size: 13px; box-shadow: rgba(0, 0, 0, 0.05) 0px 1px 4px; }
.clipboard-status #clipboardDots { font-weight: bold; color: rgb(243, 156, 18); }
.clipboard-status button { padding: 6px 12px; font-size: 13px; border-radius: 4px; background: rgb(255, 255, 255); border: 1px solid rgb(225, 232, 240); transition: 0.2s; }
.clipboard-status button:hover { background: rgb(248, 250, 252); border-color: rgb(52, 152, 219); }
.right-fields { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px; margin-bottom: 20px; padding: 16px; background: rgb(248, 250, 252); border-radius: 8px; }
.right-fields label { display: flex; flex-direction: column; gap: 6px; font-weight: 500; color: rgb(52, 73, 94); }
.right-fields input { padding: 10px; border: 1px solid rgb(225, 232, 240); border-radius: 6px; font-size: 14px; transition: 0.3s; background: rgb(255, 255, 255); }
.right-fields input:focus { outline: none; border-color: rgb(52, 152, 219); box-shadow: rgba(52, 152, 219, 0.1) 0px 0px 0px 2px; }
#itemsTable input.desc { width: 100%; padding: 10px; border: 1px solid rgb(225, 232, 240); border-radius: 6px; font-size: 14px; transition: 0.3s; background: rgb(248, 250, 252); }
#itemsTable input.qtyInput, #itemsTable input.rateInput { width: 140px; padding: 10px; border: 1px solid rgb(225, 232, 240); border-radius: 6px; font-size: 14px; transition: 0.3s; background: rgb(248, 250, 252); }
#itemsTable input.amountDisplay { width: 160px; padding: 10px; border: 1px solid rgb(225, 232, 240); border-radius: 6px; font-size: 14px; text-align: right; background: rgb(248, 250, 252); color: rgb(44, 62, 80); font-weight: 500; }
#itemsTable thead th { font-weight: 600; text-align: center; padding: 12px; color: rgb(44, 62, 80); background: rgb(248, 250, 252); }
#itemsTable input:focus { outline: none; border-color: rgb(52, 152, 219); box-shadow: rgba(52, 152, 219, 0.1) 0px 0px 0px 2px; background: rgb(255, 255, 255); }
.right-fields { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
.right-fields label { display: flex; align-items: center; gap: 8px; font-weight: 600; }
.right-fields label input { flex: 1 1 0%; margin: 0px; }
.patti-card-selected { box-shadow: rgba(50, 60, 80, 0.08) 0px 6px 28px; border-color: var(--primary); }
.patti-card-checkbox { display: flex; align-items: center; gap: 8px; margin-bottom: 6px; }
.itemRow td { vertical-align: middle; }
.itemRow .desc { padding-right: 8px; }
.top-fields { display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; }
#rate_qty, #rate_rate { width: 220px; max-width: 100%; padding: 10px; border: 1px solid rgb(225, 232, 240); border-radius: 6px; background: rgb(248, 250, 252); font-size: 14px; }
#rate_qty:focus, #rate_rate:focus { outline: none; border-color: var(--primary); box-shadow: rgba(59, 130, 246, 0.15) 0px 0px 0px 3px; background: rgb(255, 255, 255); transform: translateY(-1px); }
.discount-controls { display: flex; align-items: center; gap: 12px; position: relative; }
select#discount_select { appearance: none; background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e"); background-repeat: no-repeat; background-position: right 12px center; background-size: 16px; padding: 12px 40px 12px 16px; border: 1px solid var(--gray-200); border-radius: var(--radius-md); font-size: 15px; color: var(--gray-900); background-color: var(--gray-50); cursor: pointer; transition: var(--transition); width: 100%; min-width: 140px; }
select#discount_select:hover { border-color: var(--primary); background-color: rgb(255, 255, 255); }
select#discount_select:focus { outline: none; border-color: var(--primary); box-shadow: rgba(59, 130, 246, 0.15) 0px 0px 0px 3px; background-color: rgb(255, 255, 255); transform: translateY(-1px); }
#date_diff { font-size: 0.75rem; color: var(--gray-600); background: var(--gray-100); padding: 0.375rem 0.75rem; border-radius: var(--radius-sm); white-space: nowrap; transition: var(--transition); }
@media (max-width: 768px) {
  .discount-controls { flex-direction: column; align-items: stretch; }
  select#discount_select { width: 100%; }
  #date_diff { text-align: center; width: 100%; }
}
.editor { display: flex; gap: 20px; margin-top: 14px; }
.form { width: 420px; }
#itemsTable { margin-bottom: 12px; }
.form label { display: block; margin: 6px 0px; }
.cheque-inputs { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-top: 8px; }
.cheque-inputs label { font-size: 13px; }
.preview { background: var(--bg-card); padding: 1.5rem; border: 1px solid var(--gray-200); min-height: 400px; border-radius: var(--radius-lg); box-shadow: var(--shadow-sm); position: relative; transition: var(--transition); overflow: auto; }
.preview:hover { box-shadow: rgba(0, 0, 0, 0.05) 0px 4px 6px, rgba(0, 0, 0, 0.06) 0px 10px 32px; border-color: rgb(203, 213, 224); }
.right-controls { display: flex; gap: 12px; align-items: center; justify-content: flex-end; margin-top: 12px; flex-wrap: wrap; }
.right-controls button { min-width: 120px; }
.note-row { display: flex; justify-content: space-between; align-items: center; margin: 10px 0px; padding: 8px; border-radius: 6px; background: rgb(248, 250, 252); }
.note-row .company { font-weight: 600; color: rgb(44, 62, 80); font-size: 15px; }
.note-table { width: 100%; border-collapse: separate; border-spacing: 0px; margin-top: 16px; background: rgb(255, 255, 255); border-radius: 8px; overflow: hidden; box-shadow: rgba(0, 0, 0, 0.05) 0px 1px 4px; }
.note-table td { padding: 12px; border-bottom: 1px solid rgb(225, 232, 240); font-size: 14px; color: rgb(52, 73, 94); transition: background-color 0.2s; }
.note-table tr:hover td { background-color: rgb(248, 250, 252); }
.note-table td:first-child { width: 20%; font-weight: 500; }
.note-table td:nth-child(2) { width: 10%; text-align: center; }
.note-table td:nth-child(3) { width: 25%; }
.note-table td:nth-child(4) { width: 45%; text-align: right; font-weight: 500; }
.totals { font-weight: 700; }
.highlight { background: rgba(0, 200, 0, 0.05); padding: 8px; }
.preview .value { flex: 1 1 0%; padding-left: 8px; }
button { padding: 6px 10px; margin: 4px; }
#itemsTable { width: 100%; border-collapse: collapse; }
#itemsTable td { padding: 6px; }
#itemsTable input[type="number"] { width: 100%; }
#note { width: 720px; height: auto; }
.help { font-size: 12px; color: rgb(102, 102, 102); margin-top: 12px; }
.cheque-inputs label { display: block; margin: 6px 0px; }
.cheque-preview { display: flex; flex-direction: column; align-items: flex-end; margin-top: 10px; }
.cheque-preview div { font-weight: 600; }
.chq-row .chq-amount { font-weight: 700; }
.cheque-row-right { display: flex; justify-content: flex-end; gap: 18px; margin-top: 6px; }
.cheque-row-right .cheque-item { min-width: 120px; text-align: right; }
.cheque-stack-wrap { display: flex; justify-content: flex-end; margin-top: -6px; }
.cheque-stack { display: flex; flex-direction: column; gap: 4px; align-items: flex-end; }
.cheque-box { border: 1px solid rgb(85, 85, 85); padding: 4px 8px; min-width: 140px; text-align: right; background: rgb(250, 250, 250); font-size: 12px; }
.chq-amount-box { font-weight: 800; background: rgb(255, 255, 255); font-size: 13px; padding: 6px 8px; }
.note-row.totals.highlight { background: rgb(233, 246, 234); padding: 10px; border-radius: 2px; }
.sheet { width: 100%; border-collapse: collapse; font-family: "Segoe UI", Arial, sans-serif; table-layout: fixed; }
.sheet td { border: 1px solid rgb(221, 221, 221); padding: 4px 6px; font-size: 12px; vertical-align: middle; text-align: center; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 0px; }
.sheet td.label { font-weight: 700; background: rgb(255, 255, 255); }
.sheet td.merged { background: rgb(255, 255, 255); padding-left: 8px; text-align: left; }
.sheet td.value { text-align: center; font-weight: 600; }
.sheet tr .highlight { background: rgb(233, 246, 234); font-weight: 800; }
.sheet td { font-family: Calibri, "Segoe UI", Arial, sans-serif; }
.sheet tbody tr { min-height: 28px; height: 28px; transition: background-color var(--transition); }
.sheet tbody tr:hover { background-color: var(--gray-50); }
@media (max-width: 768px) {
  .sheet { font-size: 11px; }
  .sheet td { padding: 4px; }
  .preview { padding: 12px; margin: 12px -12px; border-radius: 0px; border-left: none; border-right: none; }
}
@media (max-width: 480px) {
  .app { padding: 12px; }
  .controls { margin: -12px; padding: 12px; }
  .inputs-grid { padding: 0px; }
  .right-controls { padding: 12px; margin: 0px -12px; background: var(--gray-50); border-top: 1px solid var(--gray-200); }
  .right-controls button { flex: 1 1 0%; min-width: 0px; padding: 12px; }
}
#B1, #B2 { font-weight: 700; text-align: center; }
#B1_value { display: block; transition: var(--transition); }
.flash { animation: 0.7s ease 0s 1 normal none running flash; }
@keyframes flash { 
  0% { background: rgba(59, 130, 246, 0.1); }
  100% { background: transparent; }
}
@keyframes fadeIn { 
  0% { opacity: 0; transform: translateY(10px); }
  100% { opacity: 1; transform: translateY(0px); }
}
.preview { animation: 0.3s ease-out 0s 1 normal none running fadeIn; }
@media (hover: none) {
  button:hover, select:hover, .name-input button:hover, .preview:hover { transform: none !important; }
  input:focus, select:focus, .name-input input:focus { transform: none; }
  .right-controls button { min-height: 44px; }
}
#B1, #B1_value { font-size: 14px; color: rgb(0, 0, 0); line-height: 1.2; }
#B5, #C5, #D5 { font-weight: 600; text-align: center; }
#E5, #E6, #E7, #E8, #E9, #E11, #I6 { font-weight: 700; text-align: center; }
#A1, #A2, #A3, #A4, #A5, #A6, #A7, #A8, #A9, #A10, #A11 { font-weight: 700; }
#A11 { background: rgb(232, 245, 233); font-weight: 700; color: rgb(46, 125, 50); }
#D11, #E11 { background: rgb(232, 245, 233); font-weight: 900; color: rgb(46, 125, 50); font-size: 15px; }
#H6, #H7, #H8, #H9 { font-weight: 600; text-align: left; padding: 12px; color: rgb(44, 62, 80); }
#I6, #I7, #I8, #I9 { border-left: 2px solid rgb(52, 152, 219); background: rgb(248, 250, 252); }
.items-nested { width: 100%; border-collapse: separate; border-spacing: 0px 4px; }
.items-nested td { border: none; padding: 8px 12px; text-align: right; font-size: 14px; color: rgb(52, 73, 94); }
.cheque-stack { display: flex; flex-direction: column; align-items: flex-end; gap: 10px; padding: 12px; background: rgb(255, 255, 255); border-radius: 8px; box-shadow: rgba(0, 0, 0, 0.05) 0px 1px 4px; }
.cheque-box { min-width: 180px; padding: 10px 16px; background: rgb(248, 250, 252); border-radius: 6px; border: 1px solid rgb(225, 232, 240); transition: 0.2s; }
.cheque-box:hover { border-color: rgb(52, 152, 219); background: rgb(255, 255, 255); }
.cheque-col { vertical-align: top; padding: 16px; background: rgb(255, 255, 255); border-radius: 8px; }
.value, .items-nested td, .cheque-box span { display: block; text-align: center; }
.pos { background: rgba(0, 150, 0, 0.08); color: rgb(0, 100, 0); font-weight: 800; }
.neg { background: rgba(200, 0, 0, 0.06); color: rgb(164, 0, 0); font-weight: 800; }
.sheet td { border-color: rgb(230, 230, 230); }
#D10_value { max-width: 100%; overflow: hidden; text-overflow: ellipsis; -webkit-line-clamp: 3; -webkit-box-orient: vertical; display: -webkit-box; white-space: normal; word-break: break-word; }
button { padding: 12px 24px; border: 1px solid rgb(226, 232, 240); border-radius: 10px; background: rgb(255, 255, 255); cursor: pointer; font-size: 15px; font-weight: 500; color: rgb(45, 55, 72); transition: 0.2s cubic-bezier(0.4, 0, 0.2, 1); display: inline-flex; align-items: center; justify-content: center; gap: 8px; letter-spacing: 0.01em; box-shadow: rgba(0, 0, 0, 0.05) 0px 1px 2px, rgba(0, 0, 0, 0.03) 0px 1px 1px; }
button:hover { background: rgb(248, 250, 252); transform: translateY(-1px); box-shadow: rgba(0, 0, 0, 0.05) 0px 4px 6px, rgba(0, 0, 0, 0.03) 0px 2px 4px; border-color: rgb(203, 213, 224); }
button:active { transform: translateY(0px); box-shadow: rgba(0, 0, 0, 0.05) 0px 1px 2px; background: rgb(241, 245, 249); }
button:focus { outline: none; box-shadow: rgba(66, 153, 225, 0.15) 0px 0px 0px 3px, rgba(0, 0, 0, 0.05) 0px 1px 2px; }
button:disabled { opacity: 0.65; cursor: not-allowed; background: rgb(241, 245, 249); transform: none; box-shadow: none; border-color: rgb(226, 232, 240); }
.btn-primary { background: var(--primary); color: white; border-color: var(--primary-dark); box-shadow: var(--shadow-sm); }
.btn-primary:hover { background: var(--primary-dark); border-color: var(--primary-dark); transform: translateY(-2px); box-shadow: var(--shadow-lg); }
.btn-secondary { background: var(--secondary); color: white; border-color: var(--secondary-dark); }
.btn-secondary:hover { background: var(--secondary-dark); transform: translateY(-2px); box-shadow: var(--shadow-lg); }
.btn-accent { background: var(--accent); color: white; border-color: var(--accent); }
.btn-accent:hover { background: var(--secondary-dark); transform: translateY(-2px); box-shadow: var(--shadow-lg); }
.btn-success { background: var(--success); color: white; border-color: var(--success); }
.btn-success:hover { background: var(--success-light); transform: translateY(-2px); box-shadow: var(--shadow-lg); }
.btn-danger { background: var(--danger); color: white; border-color: var(--danger); }
.btn-danger:hover { background: rgb(185, 28, 28); transform: translateY(-2px); box-shadow: var(--shadow-lg); }
.btn-outline { background: transparent; color: var(--primary); border-color: var(--primary); }
.btn-outline:hover { background: var(--primary); color: white; transform: translateY(-2px); box-shadow: var(--shadow-lg); }
.control-group { display: flex; gap: 0.75rem; align-items: center; }
.right-controls { display: flex; flex-direction: column; gap: 0.75rem; }
#copyBtn { background: var(--secondary); color: white; border-color: var(--secondary-dark); }
.gallery-controls { display: flex; justify-content: space-between; align-items: flex-start; gap: 2rem; margin-bottom: 2rem; padding: 1.5rem; background: var(--bg-secondary); border-radius: var(--radius-lg); border: 1px solid var(--gray-200); }
.controls-section { display: flex; flex-direction: column; gap: 1rem; }
.filter-group { display: flex; align-items: center; gap: 1rem; }
.filter-label { display: flex; align-items: center; gap: 0.5rem; font-weight: 500; color: var(--gray-700); }
.filter-input { padding: 0.5rem 0.75rem; border: 1px solid var(--gray-300); border-radius: var(--radius-md); background: white; font-size: 0.875rem; transition: var(--transition); }
.filter-input:focus { outline: none; border-color: var(--primary); box-shadow: rgba(30, 64, 175, 0.1) 0px 0px 0px 3px; }
.view-options { display: flex; gap: 1.5rem; align-items: center; }
.toggle-label { display: flex; align-items: center; gap: 0.5rem; font-size: 0.875rem; font-weight: 500; color: var(--gray-700); cursor: pointer; }
.toggle-label input[type="checkbox"] { width: 1rem; height: 1rem; accent-color: var(--primary); }
.gallery-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 1.5rem; }
.empty-state { display: none; flex-direction: column; align-items: center; justify-content: center; text-align: center; padding: 4rem 2rem; color: var(--gray-500); }
.empty-state.show { display: flex; }
.empty-icon { opacity: 0.3; margin-bottom: 1rem; }
.empty-state h3 { font-size: 1.25rem; font-weight: 600; color: var(--gray-700); margin-bottom: 0.5rem; }
.empty-state p { font-size: 0.875rem; max-width: 32rem; }
.date-group { margin-bottom: 2rem; }
.date-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; padding: 1rem 1.5rem; background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%); border-radius: var(--radius-lg); color: white; box-shadow: var(--shadow-md); }
.date-title { display: flex; align-items: center; gap: 1rem; }
.date-title h3 { margin: 0px; font-size: 1.25rem; font-weight: 600; }
.item-count { background: rgba(255, 255, 255, 0.2); padding: 0.25rem 0.75rem; border-radius: var(--radius-md); font-size: 0.875rem; font-weight: 500; }
.group-controls { display: flex; gap: 0.75rem; margin-bottom: 1rem; padding: 0px 0.5rem; }
.group-controls button { font-size: 0.875rem; padding: 0.5rem 1rem; }
.patti-cards-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1.5rem; margin-bottom: 2rem; }
.patti-card { background: var(--bg-card); border: 1px solid var(--gray-200); border-radius: var(--radius-lg); overflow: hidden; box-shadow: var(--shadow-sm); transition: var(--transition); position: relative; }
.patti-card:hover { transform: translateY(-3px); box-shadow: var(--shadow-lg); border-color: var(--primary-light); }
.patti-card-selected { border-color: var(--primary); box-shadow: rgba(30, 64, 175, 0.1) 0px 0px 0px 3px; }
.patti-card-header { padding: 0.75rem 1rem; background: var(--gray-50); border-bottom: 1px solid var(--gray-200); }
.patti-card-checkbox { display: flex; align-items: center; gap: 0.5rem; font-size: 0.875rem; font-weight: 500; color: var(--gray-700); margin: 0px; cursor: pointer; }
.patti-checkbox { width: 1rem; height: 1rem; accent-color: var(--primary); }
.patti-image-container { position: relative; overflow: hidden; cursor: pointer; }
.patti-image { width: 100%; height: 200px; object-fit: contain; background: var(--gray-50); transition: var(--transition); }
.patti-image-overlay { position: absolute; inset: 0px; background: rgba(30, 64, 175, 0.9); display: flex; align-items: center; justify-content: center; opacity: 0; transition: var(--transition); }
.patti-image-container:hover .patti-image-overlay { opacity: 1; }
.patti-image-container:hover .patti-image { transform: scale(1.05); }
.overlay-content { display: flex; flex-direction: column; align-items: center; gap: 0.5rem; color: white; text-align: center; }
.overlay-content svg { opacity: 0.8; }
.overlay-content span { font-size: 0.875rem; font-weight: 500; }
.patti-card-footer { padding: 1rem; display: flex; justify-content: space-between; align-items: flex-start; gap: 1rem; }
.patti-card-info h4 { font-size: 1rem; font-weight: 600; color: var(--gray-900); margin-bottom: 0.25rem; }
.patti-card-info p { font-size: 0.875rem; color: var(--gray-500); }
.patti-card-actions { display: flex; flex-wrap: wrap; gap: 0.5rem; }
.btn-sm { padding: 0.375rem 0.75rem; font-size: 0.75rem; border-radius: var(--radius-sm); }
.image-modal { position: fixed; inset: 0px; z-index: 9999; animation: 0.2s ease 0s 1 normal none running fadeIn; }
@keyframes fadeIn { 
  0% { opacity: 0; }
  100% { opacity: 1; }
}
.modal-overlay { position: absolute; inset: 0px; background: rgba(0, 0, 0, 0.8); display: flex; align-items: center; justify-content: center; padding: 2rem; }
.modal-content { background: var(--bg-card); border-radius: var(--radius-xl); box-shadow: var(--shadow-xl); max-width: 90vw; max-height: 90vh; display: flex; flex-direction: column; overflow: hidden; }
.modal-header { display: flex; justify-content: space-between; align-items: center; padding: 1.5rem; border-bottom: 1px solid var(--gray-200); background: var(--gray-50); }
.modal-header h3 { margin: 0px; font-size: 1.25rem; font-weight: 600; color: var(--gray-900); }
.modal-close { background: none; border: none; font-size: 2rem; cursor: pointer; color: var(--gray-500); transition: var(--transition); padding: 0px; width: 2rem; height: 2rem; display: flex; align-items: center; justify-content: center; }
.modal-close:hover { color: var(--gray-700); background: var(--gray-200); border-radius: 50%; }
.modal-body { padding: 1.5rem; display: flex; align-items: center; justify-content: center; }
.modal-image { max-width: 100%; max-height: 70vh; object-fit: contain; border-radius: var(--radius-lg); box-shadow: var(--shadow-md); }
.btn-sm:disabled { opacity: 0.7; cursor: not-allowed; }
.copy-success { background: var(--success) !important; color: white !important; }
@media (max-width: 1024px) {
  .main-content { grid-template-columns: 1fr; gap: 1.5rem; }
  .inputs-grid { grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); }
  .top-fields { grid-template-columns: 1fr 1fr; }
}
@media (max-width: 768px) {
  .app { padding: 1rem; }
  .inputs-grid { grid-template-columns: 1fr; gap: 0.75rem; }
  .top-fields { grid-template-columns: 1fr; gap: 0.75rem; }
  .gallery-controls { flex-direction: column; gap: 1rem; padding: 1rem; }
  .controls-section { width: 100%; }
  .filter-group { flex-wrap: wrap; }
  .view-options { flex-wrap: wrap; gap: 1rem; }
  .gallery-grid { grid-template-columns: 1fr; }
  .header { flex-direction: column; gap: 1rem; text-align: center; }
  .header-actions { width: 100%; justify-content: center; }
  .right-controls { flex-direction: column; width: 100%; }
  .control-group { flex-wrap: wrap; justify-content: center; }
  h1 { font-size: 1.75rem; }
}
@media (max-width: 480px) {
  body { padding: 0.5rem; }
  .app { padding: 0.75rem; border-radius: var(--radius-lg); }
  .form-section, .preview-section, .controls-section { padding: 1rem; }
  .inputs-grid { gap: 0.75rem; }
  .field-group input, .field-group select { padding: 0.625rem 0.75rem; font-size: 0.875rem; }
  .name-input { flex-direction: column; gap: 0.5rem; align-items: stretch; }
  .name-input button { width: 100%; justify-content: center; height: auto; padding: 0.625rem 1rem; }
  .name-select { width: 100%; }
  .control-group { flex-direction: column; gap: 0.5rem; }
  .control-group button { width: 100%; justify-content: center; }
  .discount-controls { flex-direction: column; gap: 0.5rem; }
  .gallery-grid { gap: 1rem; }
  .patti-cards-grid { grid-template-columns: 1fr; gap: 1rem; }
  .patti-card-footer { flex-direction: column; gap: 0.75rem; }
  .patti-card-actions { justify-content: center; }
  .group-controls { flex-wrap: wrap; justify-content: center; }
  .date-header { padding: 1rem; }
  .date-title { flex-direction: column; gap: 0.5rem; text-align: center; }
  .modal-content { margin: 1rem; max-width: calc(-2rem + 100vw); max-height: calc(-2rem + 100vh); }
  .modal-body { padding: 1rem; }
  .preview { min-height: 300px; padding: 1rem; }
}
#copyBtn:hover { background: rgb(37, 99, 235); box-shadow: rgba(59, 130, 246, 0.15) 0px 4px 6px, rgba(0, 0, 0, 0.05) 0px 2px 4px; }
#copyBtn:disabled { background: rgb(191, 219, 254); color: rgb(30, 64, 175); border-color: rgb(147, 197, 253); }
#exportBtn { background: rgb(16, 185, 129); color: white; border-color: rgb(5, 150, 105); box-shadow: rgba(16, 185, 129, 0.15) 0px 1px 3px, rgba(0, 0, 0, 0.05) 0px 1px 2px; }
#exportBtn:hover { background: rgb(5, 150, 105); box-shadow: rgba(16, 185, 129, 0.15) 0px 4px 6px, rgba(0, 0, 0, 0.05) 0px 2px 4px; }
#resetBtn { background: rgb(239, 68, 68); color: white; border-color: rgb(220, 38, 38); box-shadow: rgba(239, 68, 68, 0.15) 0px 1px 3px, rgba(0, 0, 0, 0.05) 0px 1px 2px; }
#resetBtn:hover { background: rgb(220, 38, 38); box-shadow: rgba(239, 68, 68, 0.15) 0px 4px 6px, rgba(0, 0, 0, 0.05) 0px 2px 4px; }

    </style>
    <foreignObject width='100%' height='100%'>
      <div xmlns="http://www.w3.org/1999/xhtml" class="preview" id="note">
          <table class="sheet" role="grid">
            <colgroup>
                <col style="width:11.1111%" />
                <col style="width:11.1111%" />
                <col style="width:11.1111%" />
                <col style="width:11.1111%" />
                <col style="width:11.1111%" />
                <col style="width:11.1111%" />
                <col style="width:11.1111%" />
                <col style="width:11.1111%" />
                <col style="width:11.1111%" />
              </colgroup>
            <tbody>
              <!-- Row 1 -->
              <tr>
                <td id="A1">MILLER NAME</td>
                  <td id="B1" colspan="8" class="merged"></td>
              </tr>
              <!-- Row 2 -->
              <tr>
                <td id="A2">PARTY NAME</td>
                <td id="B2" colspan="8" class="merged"></td>
              </tr>
              <!-- Row 3 -->
              <tr>
                <td id="A3">BILL NO</td>
                <td id="B3"></td>
                <td id="C3"> </td>
                <td id="D3"> </td>
                <td id="E3"> </td>
                <td id="F3"> </td>
                <td id="G3"> </td>
                <td id="H3"> </td>
                <td id="I3"> </td>
              </tr>
              <!-- Row 4 -->
              <tr>
                <td id="A4">ARRIVAL DT</td>
                <td id="B4"></td>
                <td id="C4"> </td>
                <td id="D4"> </td>
                <td id="E4" colspan="3" class="merged"> </td>
                <td id="H4"> </td>
                <td id="I4"> </td>
              </tr>
              <!-- Row 5 (RATE) -->
              <tr>
                <td id="A5">RATE</td>
                <td id="B5">0</td>
                <td id="C5"></td>
                <td id="D5">0</td>
                <td id="E5" colspan="3" class="merged">0</td>
                <td id="H5"> </td>
                <td id="I5"> </td>
              </tr>
              <!-- Row 6 (LORRY HIRE) -->
              <tr>
                <td id="A6">LORRY HIRE</td>
                <td id="B6">0</td>
                <td id="C6"> </td>
                <td id="D6"> </td>
                <!-- E6 spans E/F/G; include a dedicated span for E6_value and a separate span for G6 so scripts can target G6 without being overwritten -->
                <td id="E6" colspan="3" class="merged">0</td>
                <td id="H6">CHQ AM</td>
                <td id="I6">0</td>
              </tr>
              <!-- Row 7 (DISCOUNT) -->
              <tr>
                <td id="A7">DISCOUNT</td>
                <td id="B7">0</td>
                <td id="C7"> </td>
                <td id="D7"> </td>
                <td id="E7" colspan="3" class="merged">0</td>
                <td id="H7">CHQ NO</td>
                <td id="I7"></td>
              </tr>
              <!-- Row 8 (SELLER COM) -->
              <tr>
                <td id="A8">SELLER COM</td>
                <td id="B8">0</td>
                <td id="C8"> </td>
                <td id="D8"> </td>
                <td id="E8" colspan="3" class="merged">0</td>
                <td id="H8">CHQ DT</td>
                <td id="I8"></td>
              </tr>
              <!-- Row 9 (SHORTAGE) -->
              <tr>
                <td id="A9">SHORTAGE</td>
                <td id="B9"> </td>
                <td id="C9"> </td>
                <td id="D9"> </td>
                <td id="E9" colspan="3" class="merged">0</td>
                <td id="H9">BANK</td>
                <td id="I9"></td>
              </tr>
              <!-- Row 10 (Q-DIFF) - merge D10 with row below -->
              <tr>
                <td id="A10">Q-DIFF</td>
                <td id="B10">0</td>
                <td id="C10"> </td>
                <td id="D10" rowspan="2" colspan="6" class="merged"><span id="D10_value"></span></td>
              </tr>
              <!-- Row 11 (TOTAL) - D11 merged into D10 above -->
              <tr>
                <td id="A11">TOTAL</td>
                <td id="B11">0</td>
                <td id="C11"> </td>
                <!-- D11 removed because D10 spans into this row -->
              </tr>
            </tbody>
          </table>
        </div>
    </foreignObject>
  </svg>